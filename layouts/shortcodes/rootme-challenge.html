{{/*
Root-Me Challenge Info Box Shortcode
Usage: {{< rootme-challenge slug="ftp-authentification">}}

    Les donn√©es sont lues depuis data/rootme_challenges.json
    */}}

    {{ $slug := .Get "slug" }}
    {{ $challenge := index .Site.Data.rootme_challenges $slug }}

    {{ if $challenge }}

    {{/* Translations mappings for dynamic content using Scratch to avoid scope issues */}}
    {{ $s := newScratch }}
    {{ $s.Set "difficulte" $challenge.difficulte }}
    {{ $s.Set "rubrique" $challenge.rubrique }}

    {{ if eq .Site.Language.Lang "en" }}
    {{ if eq $challenge.difficulte "Tr√®s facile" }}
    {{ $s.Set "difficulte" "Very Easy" }}
    {{ else if eq $challenge.difficulte "Facile" }}
    {{ $s.Set "difficulte" "Easy" }}
    {{ else if eq $challenge.difficulte "Moyen" }}
    {{ $s.Set "difficulte" "Medium" }}
    {{ else if eq $challenge.difficulte "Difficile" }}
    {{ $s.Set "difficulte" "Hard" }}
    {{ else if eq $challenge.difficulte "Tr√®s difficile" }}
    {{ $s.Set "difficulte" "Very Hard" }}
    {{ end }}

    {{ if eq $challenge.rubrique "R√©seau" }}
    {{ $s.Set "rubrique" "Network" }}
    {{ else if eq $challenge.rubrique "Web - Client" }}
    {{ $s.Set "rubrique" "Web - Client" }}
    {{/* Add other mappings as needed */}}
    {{ end }}
    {{ end }}

    <div
        style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 12px; padding: 2rem; margin-bottom: 2.5rem; border: 1px solid #0f3460;">
        <div
            style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 1.5rem;">
            <div>
                <h2 style="margin: 0 0 0.75rem 0; color: #4fc3f7; font-size: 2rem;">{{ $challenge.titre }}</h2>
                <p style="margin: 0; color: #26c6da; font-weight: 600; font-size: 1.4rem;">üèÜ {{ $challenge.score }}
                    Points</p>
            </div>
            <div style="display: flex; gap: 0.75rem;">
                <a href="{{ $challenge.url }}" target="_blank"
                    style="background: #1976d2; color: white; padding: 0.75rem 1.5rem; border-radius: 6px; text-decoration: none; font-size: 1rem; font-weight: bold; white-space: nowrap;">{{
                    T "rootme_see" }}</a>
            </div>
        </div>
        <hr style="border: none; border-top: 1px solid #0f3460; margin: 1.5rem 0;">
        <!-- Grille Layout -->
        <div
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1.5rem; text-align: center;">
            <div>
                <p
                    style="margin: 0; font-size: 1rem; color: #90a4ae; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">
                    {{ T "rootme_author" }}</p>
                <p
                    style="margin: 0.4rem 0 0 0; color: #e0e0e0; font-size: 1.5rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                    {{ $challenge.auteur }}</p>
                <p style="margin: 0.2rem 0 0 0; font-size: 0.9rem; color: #78909c;">{{ $challenge.date }}</p>
            </div>
            <div>
                <p
                    style="margin: 0; font-size: 1rem; color: #90a4ae; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">
                    {{ T "rootme_level" }}</p>
                <p style="margin: 0.4rem 0 0 0;">
                    {{ $diff := $challenge.difficulte }}
                    {{ $bars := "‚ñ†‚ñ°‚ñ°‚ñ°‚ñ°" }}
                    {{ if eq $diff "Tr√®s facile" }}{{ $bars = "‚ñ†‚ñ°‚ñ°‚ñ°‚ñ°" }}
                    {{ else if eq $diff "Facile" }}{{ $bars = "‚ñ†‚ñ†‚ñ°‚ñ°‚ñ°" }}
                    {{ else if eq $diff "Moyen" }}{{ $bars = "‚ñ†‚ñ†‚ñ†‚ñ°‚ñ°" }}
                    {{ else if eq $diff "Difficile" }}{{ $bars = "‚ñ†‚ñ†‚ñ†‚ñ†‚ñ°" }}
                    {{ else if eq $diff "Tr√®s difficile" }}{{ $bars = "‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†" }}
                    {{ end }}

                    {{/* Split the bars string into two parts for coloring */}}
                    <span style="color: #4caf50; font-size: 1.8rem;">{{ substr $bars 0 (strings.Count "‚ñ†" $bars)
                        }}</span><span style="color: #616161; font-size: 1.8rem;">{{ substr $bars (strings.Count "‚ñ†"
                        $bars) }}</span>
                </p>
                <p style="margin: 0.2rem 0 0 0; font-size: 0.9rem; color: #78909c;">{{ $s.Get "difficulte" }}</p>
            </div>
            <div>
                <p
                    style="margin: 0; font-size: 1rem; color: #90a4ae; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">
                    {{ T "rootme_validations" }}</p>
                <div
                    style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-top: 0.4rem;">
                    <span style="color: #4fc3f7; font-weight: bold; font-size: 1.8rem;">{{ $challenge.validations
                        }}</span>
                    {{ if $challenge.note }}
                    <span
                        style="background: #ef5350; color: white; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.9rem; font-weight: bold;">{{
                        $challenge.note }}</span>
                    {{ end }}
                </div>
                <p style="margin: 0.2rem 0 0 0; font-size: 0.9rem; color: #78909c;">{{ T "rootme_challengers" }}</p>
            </div>
            <div>
                <p
                    style="margin: 0; font-size: 1rem; color: #90a4ae; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">
                    {{ T "rootme_category" }}</p>
                <p style="margin: 0.4rem 0 0 0; color: #e0e0e0; font-size: 1.5rem; font-weight: 600;">{{
                    $s.Get "rubrique" }}</p>
            </div>
        </div>
    </div>
    {{ else }}
    <!-- Challenge data not found for slug: {{ $slug }} -->
    {{ end }}